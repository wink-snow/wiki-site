import{d as $,r,c as x,u as j,o as F,a as R,w as T,b as u,e,f as w,g as U,t as a,h as B,v as z,F as S,i as E,j as A,k as P,T as Y,l as q,m as i,s as G}from"./index-CA2PcwMq.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"prose prose-invert max-w-none mb-8"},K={class:"mb-6 flex flex-col sm:flex-row gap-4"},O={class:"flex-shrink-0"},Q=["value"],W={class:"flex-grow"},X=["placeholder"],Z={key:0,class:"bg-red-900/50 text-red-300 p-4 rounded-lg mb-4 text-center"},ee={class:"bg-slate-800 rounded-lg shadow-lg overflow-hidden"},te={class:"w-full text-left"},se={class:"divide-y divide-slate-700"},le={key:0},ae={key:1},oe={class:"p-4 font-medium text-white"},ne={class:"p-4 text-slate-200"},re={class:"p-4 text-slate-300"},ue={class:"p-4 text-slate-300"},ie={class:"p-4 text-slate-400"},de={key:1,class:"mt-6 flex items-center justify-between text-slate-400"},ce={class:"text-sm"},ve={class:"flex items-center gap-2"},fe=["disabled"],pe={class:"text-sm font-medium text-white"},me=["disabled"],xe=$({__name:"Buffs",props:{gameName:{}},setup(he){const L=j(),v=r([]),c=r(0),o=r(1),h=r(10),d=r(!0),n=r(null),f=r(""),p=r("name"),y=[{value:"name",text:"名称"},{value:"type",text:"类型"},{value:"description",text:"效果"},{value:"comment",text:"备注"},{value:"buff_id",text:"ID"}],M=x(()=>{const s=y.find(t=>t.value===p.value);return`在 "${s==null?void 0:s.text}" 中搜索...`}),g=x(()=>f.value.trim()!==""),_=x(()=>Math.ceil(c.value/h.value)),k=x(()=>{if(!g.value)return v.value;const s=(o.value-1)*h.value,t=s+h.value;return v.value.slice(s,t)}),m=x(()=>{const s=L.params.gameId;return Array.isArray(s)?s[0]:s}),b=async s=>{if(!m.value){n.value="未能在路由中找到有效的游戏ID。",d.value=!1;return}d.value=!0,n.value=null;try{const t=await q(m.value,"buffs",s,h.value);v.value=t.list,c.value=t.total,o.value=s}catch(t){console.error(t),n.value=t instanceof Error?t.message:"一个未知的错误发生了。",v.value=[],c.value=0}finally{d.value=!1}},N=async(s,t)=>{if(!m.value){n.value="未能在路由中找到有效的游戏ID。",d.value=!1;return}d.value=!0,n.value=null;try{const l=await G(m.value,"buffs",s,t);v.value=l.list,c.value=l.total,o.value=1}catch(l){console.error(l),n.value=l instanceof Error?l.message:"一个未知的错误发生了。",v.value=[],c.value=0}finally{d.value=!1}},D=s=>{s>0&&s<=_.value&&(g.value?o.value=s:b(s))},I=r(!1),C=()=>{I.value=window.scrollY>400},V=()=>{window.scrollTo({top:0,behavior:"smooth"})};return F(()=>{b(1),window.addEventListener("scroll",C)}),R(()=>{window.removeEventListener("scroll",C)}),T(m,(s,t)=>{s&&s!==t&&(console.log(`游戏ID从 ${t} 变为 ${s}，重新加载数据。`),f.value="",b(1))}),T([f,p],([s],[t])=>{s.trim()!==t.trim()&&(g.value?N(p.value,s.trim()):b(1))}),(s,t)=>(i(),u("div",null,[t[8]||(t[8]=e("h1",{class:"text-3xl font-bold text-white mb-6"},"特征表",-1)),e("div",J,[e("p",null," 这里是 "+a(s.gameName)+" 中所有特征的详细列表。你可以通过下方的表格查询它们的ID、种类和效果。 ",1)]),e("div",K,[e("div",O,[B(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l),class:"w-full sm:w-auto h-11 px-4 bg-slate-700 border border-slate-600 text-white rounded-md focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition"},[(i(),u(S,null,E(y,l=>e("option",{key:l.value,value:l.value},a(l.text),9,Q)),64))],512),[[z,p.value]])]),e("div",W,[B(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),placeholder:M.value,class:"w-full h-11 px-4 bg-slate-700 border border-slate-600 text-white rounded-md placeholder-slate-400 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition"},null,8,X),[[A,f.value]])])]),n.value?(i(),u("div",Z,[e("p",null,"数据加载失败："+a(n.value),1)])):w("",!0),e("div",ee,[e("table",te,[t[6]||(t[6]=e("thead",{class:"bg-slate-700"},[e("tr",null,[e("th",{class:"p-4 text-sm font-semibold text-slate-300 uppercase"},"ID"),e("th",{class:"p-4 text-sm font-semibold text-slate-300 uppercase"},"名称"),e("th",{class:"p-4 text-sm font-semibold text-slate-300 uppercase"},"类型"),e("th",{class:"p-4 text-sm font-semibold text-slate-300 uppercase"},"效果"),e("th",{class:"p-4 text-sm font-semibold text-slate-300 uppercase"},"备注")])],-1)),e("tbody",se,[d.value?(i(),u("tr",le,t[4]||(t[4]=[e("td",{colspan:"5",class:"p-8 text-center text-slate-400"},[e("p",null,"正在加载数据...")],-1)]))):!n.value&&k.value.length===0?(i(),u("tr",ae,t[5]||(t[5]=[e("td",{colspan:"5",class:"p-8 text-center text-slate-400"},[e("p",null,"没有找到任何特征。")],-1)]))):(i(!0),u(S,{key:2},E(k.value,l=>(i(),u("tr",{key:l.buff_id,class:"hover:bg-slate-700/50 transition-colors duration-150"},[e("td",oe,a(l.buff_id),1),e("td",ne,a(l.name),1),e("td",re,a(l.type),1),e("td",ue,a(l.description),1),e("td",ie,a(l.comment),1)]))),128))])])]),!d.value&&c.value>0?(i(),u("div",de,[e("div",null,[e("span",ce,"共 "+a(c.value)+" 条",1)]),e("div",ve,[e("button",{onClick:t[2]||(t[2]=l=>D(o.value-1)),disabled:o.value===1,class:"px-3 py-1 rounded bg-slate-700 hover:bg-slate-600 disabled:bg-slate-800 disabled:text-slate-600 disabled:cursor-not-allowed transition-colors"}," 上一页 ",8,fe),e("span",pe,"第 "+a(o.value)+" / "+a(_.value)+" 页",1),e("button",{onClick:t[3]||(t[3]=l=>D(o.value+1)),disabled:o.value===_.value,class:"px-3 py-1 rounded bg-slate-700 hover:bg-slate-600 disabled:bg-slate-800 disabled:text-slate-600 disabled:cursor-not-allowed transition-colors"}," 下一页 ",8,me)])])):w("",!0),U(Y,{name:"fade-up"},{default:P(()=>[I.value?(i(),u("button",{key:0,onClick:V,class:"fixed bottom-16 right-8 z-50 w-12 h-12 rounded-full bg-indigo-400 text-white flex items-center justify-center shadow-lg hover:bg-sky-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-sky-500 transition-all duration-300","aria-label":"回到顶部"},t[7]||(t[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 15l7-7 7 7"})],-1)]))):w("",!0)]),_:1})]))}}),_e=H(xe,[["__scopeId","data-v-5c175cdc"]]);export{_e as default};
